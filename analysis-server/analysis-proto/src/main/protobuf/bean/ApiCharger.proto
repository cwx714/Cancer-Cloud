/**
 * 充电桩TCU设备的API接口请求/应答的消息定义。
 */

syntax = "proto2";

package ChargerLink.Gateway;
option java_package     = "com.chargerlink.gateway.bean.api";
option go_package       = "com.chargerlink.gateway.bean.api";
option csharp_namespace = "com.chargerlink.gateway.bean.api";
option java_multiple_files = false;

import "bean/EnumCharger.proto";
import "bean/DataCharger.proto";
import "google/protobuf/any.proto";

/** ChargeLink公司的充电桩TCU设备的命令请求的消息定义。*/
message CommandChargerCL_v2 {
	oneof                 command {                                 /// (必填)ChargeLink公司的充电桩TCU的命令请求。可选类型如下：
		CmdRemoteStart    remote_start    = 1;                      ///    远程启动充电的命令。终端设备返回命令应答。对应ChargeLink公司的Protobuf协议V1版的RequestStart.Request消息/V2版的RemoteStartTransactionReq消息。
		CmdRemoteStop     remote_stop     = 2;                      ///    远程结束充电的命令。终端设备返回命令应答。对应ChargeLink公司的Protobuf协议V1版的RequestStop.Request消息/V2版的RemoteStopTransactionReq消息。
		CmdReserveStart   reserve_start   = 3;                      ///    远程预约充电的命令。终端设备返回命令应答。对应ChargeLink公司的Protobuf协议V2版的ReserveNowReq消息。
		CmdReserveCancel  reserve_cancel  = 4;                      ///    远程取消预约的命令。终端设备返回命令应答。对应ChargeLink公司的Protobuf协议V2版的CancelReservationReq消息。
		CmdRemoteControl  remote_control  = 5;                      ///    设备远程控制的命令。终端设备返回命令应答。对应ChargeLink公司的Protobuf协议V1版的Reset.Request、ParkLock.Request消息/V2版的RemoteControlReq消息。
		CmdSetConfig      set_config      = 10;                     ///    设置设备配置的命令。终端设备返回命令应答。对应ChargeLink公司的Protobuf协议V1版的SetConfiguration.Request消息/V2版的ChangeConfigurationReq消息。
		CmdGetConfig      get_config      = 11;                     ///    获取设备配置的命令。终端设备返回命令应答。对应ChargeLink公司的Protobuf协议V2版的GetConfigurationReq消息。
		CmdSetPrice       set_price       = 12;                     ///    设置价格模板的命令。终端设备返回命令应答。对应ChargeLink公司的Protobuf协议V1版的SetPricing.Request消息/V2版的SetPriceReq消息。
		CmdUpdateFirmware update_firmware = 13;                     ///    更新设备固件的命令。终端设备不返回命令应答。对应ChargeLink公司的Protobuf协议V1版的UpgradeFirmware.Request消息/V2版的UpdateFirmwareReq消息。
		CmdTriggerOrders  trigger_orders  = 20;                     ///    获取离线交易记录的命令。终端设备返回命令应答。对应ChargeLink公司的Protobuf协议V1版的GetTransactions.Request消息/V2版的GetTransactionsReq消息。
		CmdTriggerWarns   trigger_warns   = 21;                     ///    获取设备告警记录的命令。终端设备返回命令应答。对应ChargeLink公司的Protobuf协议V2版的GetWarningReq消息。
		CmdTriggerDiags   trigger_diags   = 22;                     ///    获取设备诊断日志的命令。终端设备返回命令应答。对应ChargeLink公司的Protobuf协议V2版的GetDiagnosticsReq消息。
		CmdTriggerMessage trigger_message = 23;                     ///    触发设备消息重发的命令。终端设备不返回命令应答。对应ChargeLink公司的Protobuf协议V2版的TriggerMessageReq消息。
	}

	/** 远程启动充电命令的消息定义。对应ChargeLink公司的Protobuf协议V1版的RequestStart.Request消息/V2版的RemoteStartTransactionReq消息。*/
	message CmdRemoteStart {
		required uint32              plug_id      = 1;              /// (必填)充电枪ID(从1开始)。
		required string              user_id      = 2;              /// (必填)用户身份识别号。如：充电卡号、用户ID等。
		optional ChgUserType         user_type    = 3;              /// (可选)用户身份类型。
		optional int32               user_balance = 4;              /// (可选)用户账户余额。单位：0.01元。
		optional string              pin_code     = 5;              /// (可选)充电服务校验码。
		optional bool                pin_auth     = 6;              /// (可选)开启充电是否需要验证校验码。true：需要验证，false：不需要验证。
		optional int64               start_time   = 7;              /// (可选)定时启动时间(北京时间的毫秒时间戳)。单位：毫秒。null或小于当前时间：立即启动充电。
		required string              svp_order_id = 10;             /// (必填)业务系统生成的全局唯一充电订单号。
		optional ChgServiceType      service_type = 20;             /// (可选)充电服务类型。
		optional DataChgPriceScheme  price_scheme = 21;             /// (可选)计费模板。主要用于针对特定用户启用特定计费模版的场景。
		optional uint32              allow_minute = 22;             /// (可选)最大充电时间。单位：1分钟，null或等于0：表示不限制。
		optional uint32              allow_kwh    = 23;             /// (可选)最大充电电量。单位：1kwh。null或等于0：表示不限制。
		optional uint32              allow_money  = 24;             /// (可选)最大充电价格，单位：0.01元。null或等于0：表示不限制。
		optional google.protobuf.Any device_extra = 30;             /// (可选)设备附加信息。即需要透传到终端设备的自定义信息。具体使用和传输方法，根据设备类型自行实现。
		optional google.protobuf.Any server_extra = 31;             /// (可选)平台附加信息。即需要保存到服务器订单消息的自定义信息。具体使用和传输方法，根据设备类型自行处理。
	}

	/** 远程结束充电命令的消息定义。对应ChargeLink公司的Protobuf协议V1版的RequestStop.Request消息/V2版的RemoteStopTransactionReq消息。*/
	message CmdRemoteStop {
		required string svp_order_id = 1;                           /// (必填)业务系统生成的全局唯一充电订单号。
		optional uint32 plug_id      = 2;                           /// (可选)充电枪ID(从1开始)。用于设备验证是否允许停止充电。
		optional string user_id      = 3;                           /// (可选)用户身份识别号。如：充电卡号、用户ID等。用于设备验证是否允许停止充电。
	}

	/** 远程预约充电命令的消息定义。对应ChargeLink公司的Protobuf协议V2版的ReserveNowReq消息。*/
	message CmdReserveStart {
		required uint32      plug_id     = 1;                       /// (必填)充电枪ID(从1开始)。
		required string      user_id     = 2;                       /// (必填)用户身份识别号。如：充电卡号、用户ID等。
		optional ChgUserType user_type   = 3;                       /// (可选)用户身份类型。
		required int64       expire_time = 4;                       /// (必填)预约过期时间(北京时间的毫秒时间戳)。单位：毫秒。
		required string      svp_book_id = 10;                      /// (必填)业务系统生成的全局唯一预约订单号。
	}

	/** 远程取消预约命令的消息定义。对应ChargeLink公司的Protobuf协议V2版的CancelReservationReq消息。*/
	message CmdReserveCancel {
		required string svp_book_id = 1;                            /// (必填)业务系统生成的全局唯一预约订单号。
		optional uint32 plug_id     = 2;                            /// (可选)充电枪ID(从1开始)。用于设备验证是否允许停止充电。
		optional string user_id     = 3;                            /// (可选)用户身份识别号。如：充电卡号、用户ID等。用于设备验证是否允许停止充电。
	}

	/** 设备远程控制命令的消息定义。对应ChargeLink公司的Protobuf协议V1版的Reset.Request、ParkLock.Request消息/V2版的RemoteControlReq消息。*/
	message CmdRemoteControl {
		required string function  = 1;                              /// (必填)远程控制命令名称。其中：命令名称为FunctionName的值对应的字符串。
		optional string parameter = 2;                              /// (可选)远程控制命令参数。

		/** 远程控制命令名称的常量定义。对应ChargeLink公司的Protobuf协议V2版的远程控制功能列表。*/
		enum FunctionName {
			Reset              = 1;                                 /// 重启充电桩。参数：无。
			UnlockConnector    = 2;                                 /// 枪头解锁。参数：充电枪ID。
			RemoteStart        = 3;                                 /// 开启充电。参数：充电枪ID。
			RemoteStop         = 4;                                 /// 停止充电。参数：充电枪ID。
			UpdateSSLCert      = 7;                                 /// 升级SSL证书。参数：证书内容字符串。
			ChangeAvailability = 8;                                 /// 设置充电服务状态。参数：0：不提供服务，1：提供服务。
		}
	}

	/** 设置设备配置命令的消息定义。对应ChargeLink公司的Protobuf协议V1版的SetConfiguration.Request消息/V2版的ChangeConfigurationReq消息。*/
	message CmdSetConfig {
		map<string, string> config_list = 1;                        /// (必填)设置的配置参数值列表。格式为：参数名称->参数值。其中：参数名称为ConfigName的值对应的字符串。

		/** 设备配置参数名称的常量定义。对应ChargeLink公司的Protobuf协议V2版的配置参数定义。*/
		enum ConfigName {
			ServerUrl     = 1;                                      /// 服务器地址及端口号。类型：string，可写。
			User          = 2;                                      /// 服务器登录用户名。类型：string，可写。
			Password      = 3;                                      /// 服务器登录密码。类型：string，可写。
			AdmPassword   = 4;                                      /// 本地管理员密码。类型：string，可写。
			BMSInt        = 5;                                      /// BMS信息上报时间间隔。类型：int，可写。
			MeterChgInt   = 6;                                      /// 充电时电表上报时间间隔。类型：int，可写。
			MeterIdleInt  = 7;                                      /// 空闲时电表上报时间间隔。类型：int，可写。
			HeartbeatInt  = 8;                                      /// 心跳时间间隔。类型：int，可写。
			ReconnectInt  = 9;                                      /// 断线后重连时间间隔。类型：int，可写。
			BootInt       = 10;                                     /// 启动通知重发时间间隔。类型：int，可写。
			SysInt        = 11;                                     /// 充电时系统遥测间隔。类型：int，可写。
			SysIdleInt    = 12;                                     /// 空闲时系统遥测间隔。类型：int，可写。
			ELossRatio    = 13;                                     /// 电损系数。类型：int，可写。
			MeterMAC1     = 14;                                     /// 电表1地址。类型：string，可写。
			MeterMAC2     = 15;                                     /// 电表2地址。类型：string，可写。
			MeterMAC3     = 16;                                     /// 电表3地址。类型：string，可写。
			MeterMAC4     = 17;                                     /// 电表4地址。类型：string，可写。
			MeterNum      = 18;                                     /// 电表数量。类型：int，只读。
			OffLineEnable = 19;                                     /// 允许离线充电。类型：bool(0：禁止，1：允许)，可写。
			Availability  = 20;                                     /// 充电服务状态，类型：bool(0：不提供服务，1：提供服务)，可写。
			PartNumber    = 21;                                     /// 设备型号。类型：string，只读。
			SerialNumber  = 22;                                     /// 设备序列号。类型：string，只读。
			VID           = 23;                                     /// 供应商代码。类型：string，只读。
			FWVersion     = 24;                                     /// 固件版本号。类型：string，只读。
			PTVersion     = 25;                                     /// 协议版本。类型：string，只读。
			ConNum        = 26;                                     /// 充电接口数量。类型：int，只读。
			ConType       = 27;                                     /// 充电接口类型。类型：int(0：交流，1：直流)，只读。
			MAC           = 28;                                     /// 设备MAC地址。类型：string，只读。
			SectionPath   = 29;                                     /// 分区路径。类型：string，可写。
			QRCodeHeader  = 30;                                     /// 充电桩二维码前缀。类型：string，可写。
			QRCode        = 31;                                     /// 充电桩二维码。类型：string，可写。
			ServiceNumber = 32;                                     /// 客服电话。类型：string，可写。
		}
	}

	/** 获取设备配置命令的消息定义。对应ChargeLink公司的Protobuf协议V2版的GetConfigurationReq消息。*/
	message CmdGetConfig {
		repeated string key_list = 1;                               /// (必填)获取的配置参数名称列表。其中：参数名称为ConfigName的值对应的字符串。
	}

	/** 设置价格模板命令的消息定义。对应ChargeLink公司的Protobuf协议V1版的SetPricing.Request消息/V2版的SetPriceReq消息。*/
	message CmdSetPrice {
		repeated DataChgPriceScheme     price_list        = 1;      /// (必填)计费模版列表。
		map<uint32, DataChgPricePeriod> period_list       = 2;      /// (必填)计费时间段列表。格式为：计费模版ID->计费时间段。
		optional int32                  normal_scheme_id  = 3;      /// (可选)平日计费模版ID。
		optional int32                  weekend_scheme_id = 4;      /// (可选)周末/休息日计费模版ID。
	}

	/** 更新设备固件命令的消息定义。对应ChargeLink公司的Protobuf协议V1版的UpgradeFirmware.Request消息/V2版的UpdateFirmwareReq消息。*/
	message CmdUpdateFirmware {
		required string firmware_url   = 1;                         /// (必填)固件下载地址。
		required string firmware_md5   = 2;                         /// (必填)固件MD5校验。
		optional uint32 retry_count    = 3;                         /// (可选)重试次数。缺省或0：表示一直重试。
		optional uint32 retry_interval = 4;                         /// (可选)重试间隔。单位：1秒。
		optional int64  download_time  = 5;                         /// (可选)开始下载时间(北京时间的毫秒时间戳)。单位：毫秒。
	}

	/** 获取离线交易记录命令的消息定义。对应ChargeLink公司的Protobuf协议V1版的GetTransactions.Request消息/V2版的GetTransactionsReq消息。*/
	message CmdTriggerOrders {
		optional uint32 plug_id     = 1;                            /// (可选)指定充电枪ID(从1开始)。null：返回所有充电枪的离线记录。
		optional int32  order_level = 2;                            /// (可选)指定已结算或未结算的离线记录。
		optional int64  start_time  = 3;                            /// (可选)指定返回离线记录的开始时间(北京时间的毫秒时间戳)。单位：毫秒。null：从最早的离线记录开始返回。
		optional int64  stop_time   = 4;                            /// (可选)指定返回离线记录的结束时间(北京时间的毫秒时间戳)。单位：毫秒。null：返回后续全部离线记录。
		optional int32  offset      = 5;                            /// (可选)指定返回离线记录的偏移量(相对于开始/结束数据之间的记录)。null：从第1个离线记录开始返回。
		optional int32  count       = 6;                            /// (可选)指定返回离线记录的总数量。null：返回全部离线数据。
		optional int32  size        = 7;                            /// (可选)指定每次返回的离线记录数量。null：1次返回全部离线记录。
	}

	/** 获取设备告警记录命令的消息定义。对应ChargeLink公司的Protobuf协议V2版的GetWarningReq消息。*/
	message CmdTriggerWarns {
		optional ChgCompType   comp_type   = 1;                     /// (可选)指定组件类型。null：返回所有类型的告警记录。
		optional ChgAlarmLevel alarm_level = 2;                     /// (可选)指定返回告警记录的告警等级。null：返回所有级别的告警记录。
		optional int64         start_time  = 3;                     /// (可选)指定返回告警记录的开始时间(北京时间的毫秒时间戳)。单位：毫秒。null：从最早的告警记录开始返回。
		optional int64         stop_time   = 4;                     /// (可选)指定返回告警记录的结束时间(北京时间的毫秒时间戳)。单位：毫秒。null：返回后续全部告警记录。
		optional int32         offset      = 5;                     /// (可选)指定返回告警记录的偏移量(相对于开始/结束数据之间的记录)。null：从第1个告警记录开始返回。
		optional int32         count       = 6;                     /// (可选)指定返回告警记录的总数量。null：返回全部告警数据。
		optional int32         size        = 7;                     /// (可选)指定每次返回的告警记录数量。null：1次返回全部告警记录。
	}

	/** 获取设备诊断日志命令的消息定义。对应ChargeLink公司的Protobuf协议V2版的GetDiagnosticsReq消息。*/
	message CmdTriggerDiags {
		required string upload_url     = 1;                         /// (必填)日志上传FTP服务器地址。
		optional uint32 retry_count    = 2;                         /// (可选)日志上传失败重试次数。
		optional uint32 retry_interval = 3;                         /// (可选)日志上传失败重试间隔时间。单位：1秒。
		optional int64  start_time     = 4;                         /// (可选)指定返回日志记录的开始时间(北京时间的毫秒时间戳)。单位：毫秒。null：从最早的日志记录开始返回。
		optional int64  stop_time      = 5;                         /// (可选)指定返回日志记录的结束时间(北京时间的毫秒时间戳)。单位：毫秒。null：返回后续全部日志记录。
	}

	/** 触发设备消息重发命令的消息定义。对应ChargeLink公司的Protobuf协议V2版的TriggerMessageReq消息。*/
	message CmdTriggerMessage {
		required MessageType request_msg = 1;                       /// (必填)请求重发的消息代码。
		optional uint32      plug_id     = 2;                       /// (可选)指定充电枪ID(从1开始)。null：重发所有充电枪的对应消息。

		enum MessageType {
			MESSAGE_BOOT_NOTIFICATION_REQ               = 0x01;     /// 启动通知的请求消息。
			MESSAGE_HEARTBEAT_REQ                       = 0x02;     /// 心跳的请求消息。
			MESSAGE_FIRMWARE_STATUS_NOTIFICATION_REQ    = 0x07;     /// 远程升级状态通知的请求消息。
			MESSAGE_DIAGNOSTICS_STATUS_NOTIFICATION_REQ = 0x09;     /// 诊断日志状态通知的请求消息。
			MESSAGE_START_TRANSACTION_REQ               = 0x12;     /// 充电开始通知的请求消息。
			MESSAGE_STOP_TRANSACTION_REQ                = 0x13;     /// 充电结束通知的请求消息。
			MESSAGE_STATUS_NOTIFICATIO_NREQ             = 0x20;     /// 状态及告警通知的请求消息。
			MESSAGE_SYSTEM_TELEMETRY_REQ                = 0x21;     /// 系统信息遥测的请求消息。
			MESSAGE_DEVICE_REPORT_REQ                   = 0x22;     /// 设备报告的请求消息。
			MESSAGE_CHARGING_PROCESS_INFO_REQ           = 0x23;     /// 充电过程信息的请求消息。
			MESSAGE_TRANSACTION_LIST_REQ                = 0x31;     /// 上报离线订单的请求消息。
			MESSAGE_WARNING_LIST_REQ                    = 0x33;     /// 上报告警记录请求消息。
		}
	}
}

/** ChargeLink公司的充电桩TCU设备的命令应答的消息定义。*/
message ResultChargerCL_v2 {
	oneof                    result {                               /// (必填)ChargeLink公司的充电桩TCU的命令响应，可选类型如下：
		ResultRemoteStart    remote_start     = 1;                  ///    远程启动充电的执行结果。对应CmdRemoteStart命令请求。
		ResultRemoteStop     remote_stop      = 2;                  ///    远程结束充电的执行结果。对应CmdRemoteStop命令请求。
		ResultReserveStart   reserve_start    = 3;                  ///    远程预约充电的执行结果。对应CmdReserveStart命令请求。
		ResultResponseStatus reserve_cancel   = 4;                  ///    远程取消预约的执行结果。对应CmdReserveCancel命令请求。
		ResultResponseStatus remote_control   = 5;                  ///    设备远程控制的执行结果。对应CmdRemoteControl命令请求。
		ResultSetConfig      set_config       = 10;                 ///    设置设备配置的执行结果。对应CmdSetConfig命令请求。
		ResultGetConfig      get_config       = 11;                 ///    获取设备配置的执行结果。对应CmdGetConfig命令请求。
		ResultResponseStatus set_price        = 12;                 ///    设置价格模板的执行结果。对应CmdSetPrice请求。
		ResultTriggerList    trigger_orders   = 20;                 ///    获取离线交易记录的执行结果。对应CmdTriggerOrders命令请求。
		ResultTriggerList    trigger_warnings = 21;                 ///    获取设备告警记录的执行结果。对应CmdTriggerWarns命令请求。
		ResultTriggerDiags   trigger_diags    = 22;                 ///    获取设备诊断日志的执行结果。对应CmdTriggerDiags命令请求。
	}

	/** 通用终端命令的应答消息的常量定义。对应ChargeLink公司的Protobuf协议V1版的RequestStop.Confirm、Reset.Confirm、ParkLock.Confirm、SetPricing.Confirm消息/V2版的RemoteStopTransactionConf、CancelReservationConf、RemoteControlConf、SetPriceConf消息。*/
	enum ResultResponseStatus {
		RESULT_RESPONSE_ACCEPTED  = 0;                              /// 命令成功。
		RESULT_RESPONSE_REJECTED  = 1;                              /// 命令被拒绝。
		RESULT_RESPONSE_UNSUPPORT = 2;                              /// 命令不支持。
		RESULT_RESPONSE_INVALID   = 3;                              /// 命令无效参数。
	}

	/** 远程启动充电的应答消息的消息定义。对应ChargeLink公司的Protobuf协议V1版的RequestStart.Confirm、TransactionStarted.Request消息/V2版的RemoteStartTransactionConf、StartTransactionReq消息。*/
	message ResultRemoteStart {
		required ResultResponseStatus status     = 1;               /// (必填)启动结果。
		optional DataChgOrder         order_info = 2;               /// (可选)充电启动时充电订单消息。null：未收到充电桩的充电启动消息。
	}

	/** 远程停止充电的应答消息的消息定义。对应ChargeLink公司的Protobuf协议V1版的RequestStop.Confirm、TransactionStopped.Request消息/V2版的RemoteStopTransactionConf、StopTransactionReq消息。*/
	message ResultRemoteStop {
		required ResultResponseStatus status     = 1;               /// (必填)停止结果。
		optional DataChgOrder         order_info = 2;               /// (可选)充电停止时充电订单消息。null：未收到充电桩的充电停止消息。
	}

	/** 远程预约充电的应答消息的消息定义。对应ChargeLink公司的Protobuf协议V2版的ReserveNowConf消息。*/
	message ResultReserveStart {
		required ResultResponseStatus status   = 1;                 /// (必填)预约结果。
		optional uint32               plug_id  = 2;                 /// (可选)已预约充电枪ID(从1开始)。
		optional string               pin_code = 3;                 /// (可选)充电站校验码。
	}

	/** 设置设备配置的应答消息的常量定义。对应ChargeLink公司的Protobuf协议V1版的SetConfiguration.Confirm消息/V2版的ChangeConfigurationConf消息。*/
	enum ResultSetConfig {
		RESULT_SET_CONFIG_ACCEPTED   = 0;                           /// 参数支持且设置成功。
		RESULT_SET_CONFIG_REJECTED   = 1;                           /// 参数支持但设置失败。
		RESULT_SET_CONFIG_NEEDREBOOT = 2;                           /// 参数支持且设置成功。但需要重启生效。
		RESULT_SET_CONFIG_UNSUPPORT  = 3;                           /// 参数不支持。
	}

	/** 获取设备配置的应答消息的消息定义。对应ChargeLink公司的Protobuf协议V2版的GetConfigurationConf消息。*/
	message ResultGetConfig {
		map<string, string> config_list = 1;                        /// (必填)设置的配置参数值列表。格式为：参数名称->参数值。其中：参数名称为ConfigName的值对应的字符串。
	}

	/** 获取离线交易记录/设备告警记录的应答消息的消息定义。对应ChargeLink公司的Protobuf协议V1版的GetTransactions.Request消息/V2版的GetTransactionsConf、GetWarningConf消息。*/
	message ResultTriggerList {
		optional int32 total_count = 1;                             /// (可选)返回的总记录数。
	}

	/** 获取设备诊断日志的应答消息的消息定义。对应ChargeLink公司的Protobuf协议V2版的GetDiagnosticsConf消息。*/
	message ResultTriggerDiags {
		optional string file_name = 1;                              /// (可选)上传的日志文件名。
	}
}
